$(document).on("ui",function(g,f){var d=f.target;var c=$("<table cellspacing='0' cellpadding='0'>");var i=[],a=0;if(f.profiles!=null&&f.profiles.length>0){i.push(translate._("Profiles",1));a+=f.profiles.length;c.append($.map(f.profiles,function(l,k){var j="("+translate._("Empty").toLowerCase()+")";if(l.fullname!=null){j=l.fullname;if(l.email!=null){j+=" ("+l.email+")"}}else{if(l.email!=null){j=l.email}}return $("<tr class='searchable'>").append($("<td>").append($("<i class='far fa-user fa-fw'>")),$("<td>").text(j),$("<td align='center'>").append($("<a class='more'>").attr("title",translate._("More")).append($("<i class='far fa-ellipsis-h'>")))).attr("title",i[i.length-1]).data("event",{fill:"profile",index:k}).profilecontext([{name:translate._("First Name"),copy:l.firstname},{name:translate._("Last Name"),copy:l.lastname},{name:translate._("Email Address"),copy:l.email},{name:translate._("Birthday"),copy:l.birthdate}])}))}if(f.addresses!=null&&f.addresses.length>0){i.push(translate._("Addresses",1));a+=f.addresses.length;c.append($.map(f.addresses,function(l,n){var k=l.address!=null&&l.address.length>0?l.address.split("\n"):[];var j=[];$.each(["zip","city","country"],function(o,p){l[p]!=null&&j.push(p=="country"?l.country.name:l[p])});j.length>0&&k.push(j.join(" "));k.length=Math.min(k.length,3);var m=k.length>0?k.join("\n"):"("+translate._("Empty").toLowerCase()+")";return $("<tr class='searchable'>").append($("<td>").append($("<i class='far fa-home-alt fa-fw'>")),$("<td style='white-space: pre'>").text(m),$("<td align='center'>").append($("<a class='more'>").attr("title",translate._("More")).append($("<i class='far fa-ellipsis-h'>")))).attr("title",i[i.length-1]).data("event",{fill:"address",index:n}).profilecontext([{name:translate._("Address"),copy:l.address},{name:translate._("City"),copy:l.city},{name:translate._("US State"),copy:l.state!=null?l.state.name:null},{name:translate._("Zip Code"),copy:l.zip},{name:translate._("Country"),copy:l.country!=null?l.country.name:null},])}))}if(f.phones!=null&&f.phones.length>0){i.push(translate._("Phones",1));a+=f.phones.length;c.append($.map(f.phones,function(j,m){var l={cell:{icon:"fa-phone",label:translate._("Phone cell")},home:{icon:"fa-phone-rotary",label:translate._("Phone home")},fax:{icon:"fa-fax",label:translate._("Phone fax")},work:{icon:"fa-phone-office",label:translate._("Phone work")}};var k,o="",n="fa-phone";if(j.number!=null){o=j.cc!=null?"+"+j.cc+j.number:j.number;k=o;if(j.type!=null&&$.inArray(j.type,["cell","home","fax","work"])>=0){k+=" ("+l[j.type].label+")";n=l[j.type].icon}}else{k="("+translate._("Empty").toLowerCase()+")"}return $("<tr class='searchable'>").append($("<td>").append($("<i class='far fa-fw'>").addClass(n)),$("<td>").text(k),$("<td align='center'>").append($("<a class='more'>").attr("title",translate._("More")).append($("<i class='far fa-ellipsis-h'>")))).attr("title",i[i.length-1]).data("event",{fill:"phone",index:m}).contextmenu({items:function(){return[{text:translate._("Fill out"),icon:"far fa-arrow-alt-down",click:function(){$.ui.logmeonce.message({ui:"target",target:d.ui,name:"fill",args:{fill:"phone",index:m}});e.dialog("close")}},{text:translate._("Fill with cc"),icon:"far fa-arrow-alt-down",allowed:j.cc!=null,click:function(){$.ui.logmeonce.message({ui:"target",target:d.ui,name:"fill",args:{fill:"phone",index:m,cc:true}});e.dialog("close")}},{text:translate._("Edit"),icon:"far fa-edit",click:function(p){$.logmeonce.fireEvent("urlGoto",{url:"/profile",newtab:true})}},{text:translate._("Copy to Clipboard"),icon:"far fa-copy",click:function(){$.copyToClipboard(o)}}]}})}))}if(f.companies!=null&&f.companies.length>0){i.push(translate._("Companies",1));a+=f.companies.length;c.append($.map(f.companies,function(j,k){return $("<tr class='searchable'>").append($("<td>").append($("<i class='far fa-building fa-fw'>")),$("<td>").text(j.name!=null?j.name:"("+translate._("Empty").toLowerCase()+")"),$("<td align='center'>").append($("<a class='more'>").attr("title",translate._("More")).append($("<i class='far fa-ellipsis-h'>")))).attr("title",i[i.length-1]).data("event",{fill:"company",index:k}).profilecontext([{name:translate._("Company Name"),copy:j.name},{name:translate._("Job title"),copy:j.jobtitle},{name:translate._("Website URL"),copy:j.website},])}))}if(a>=8){c=c.before($("<div class='search-panel'>").append($("<div class='search'>").append($("<button>").attr("title",translate._("Click to search")).append($("<i class='far fa-search'>")),$("<input type='text' name='search'>").attr("placeholder",translate._("Search here")))))}var b=$("#ui-profile-fill");var h=b.length>0&&b.dialog("option","target")===d?"none":undefined;b.dialog("option","hide",null).dialog("close");var e=$("<div id='ui-profile-fill' class='select-dialog autofill'>").append(c).dialog({title:i.length===1?i[0]:translate._("Autofill"),target:d,minHeight:0,minWidth:300,maxWidth:600,resizable:false,autoOpen:false,icons:["password-generate","site-select","autofill-cards"],show:h,open:function(){$(this).css({height:"auto"}).on("click","a.more",function(j){j.preventDefault();j.stopPropagation();$(this).closest(".contextmenu").trigger({type:"contextmenu",position:{my:"right top",at:"right bottom",of:this}})}).on("click","tr",function(){$.ui.logmeonce.message({ui:"target",target:d.ui,name:"fill",args:$(this).data("event")});$(e).dialog("close")})}}).on("search",function(k){var j=$(".search-panel input",this).val().toLowerCase().trim();$(".searchable",this).each(function(){$(this).toggle(j.length<=0||$(this).text().toLowerCase().indexOf(j)>=0)})}).on("click",".search-panel button",function(){$(this).closest(".select-dialog").triggerHandler("search")}).on("keyup",".search-panel input",function(){$(this).debounce(200,function(){$(this).closest(".select-dialog").triggerHandler("search")})});$(e).dialog("widget").css("visibility","hidden");$(e).dialog("open");$(e).dialog("widget").css("visibility","visible")});(function(a){a.fn.profilecontext=function(b){return this.contextmenu({items:function(){return[{text:translate._("Edit"),icon:"far fa-edit",click:function(c){a.logmeonce.fireEvent("urlGoto",{url:"/profile",newtab:true})}},{text:translate._("Copy to Clipboard"),icon:"far fa-copy",items:a.map(b,function(c){return c.copy!=null?{text:c.name,icon:"far fa-copy",click:function(){a.copyToClipboard(c.copy)}}:null})}]}})}})(jQuery);