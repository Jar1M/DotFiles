$(document).on("ui",function(c,a){var b=$.extend(true,{authentication:"password",mobileconnect:true,"security-question":"",event:{name:"loadKey"}},a);$("<form class='verification'>").append($("<div class='login-list'>").append($("<h4>").text(translate.sprintf(translate._("%s extension require verification"),translate.company)),$("<button class='push-login' type='button'>").val("push-login").append($("<div>").append($("<span>").text(translate._("Push login")))),$("<button class='push-face' type='button'>").val("push-face").append($("<div>").append($("<span>").text(translate._("Push face")))),$("<button class='push-fingerprint' type='button'>").val("push-fingerprint").append($("<div>").append($("<span>").text(translate._("Push fingerprint")))),$("<button class='push-pin' type='button'>").val("push-pin").append($("<div>").append($("<span>").text("PIN"))),$("<button class='password' type='button'>").val("password").append($("<div>").append($("<span>").text(translate._("Password")))),$("<button class='security-question' type='button'>'").val("security-question").append($("<div>").append($("<span>").text(translate._("Security Question"))))),$("<div class='auth push-login push-face push-fingerprint push-pin error'>"),$("<div class='auth mobileconnect error'>"),$("<div class='auth mobileconnect body'>").append($("<span>").text(translate._("Phone Number")+":"),$("<input type='text' name='phone'>").val(typeof b.mobileconnect==="string"?b.mobileconnect:null)),$("<div class='auth password error'>"),$("<div class='auth password body'>").append($("<span>").text(translate._("Password Logmeonce")+":"),$("<input type='password' name='password'>")),$("<div class='auth security-question error'>"),$("<div class='auth security-question body'>").append($("<table>").append($("<tr>").append($("<td>").append($("<b>").text(translate._("Question")+":")),$("<td align='left'>").text(b["security-question"])),$("<tr>").append($("<td>").append($("<b>").text(translate._("Answer")+":")),$("<td align='left'>").append($("<input type='text' name='answer'>")))))).on("keypress","input",function(d){(d.which==10||d.which==13)&&$(this).closest(".ui-dialog").find("button:last").trigger("click")}).on("click","button",function(h){h.preventDefault();var f=$(this).closest(".login-list");var d=$(this).closest("form");if(!$(this).hasClass("active")){$("button.active",f).removeClass("active");var g=$(this).addClass("active").val();$(".auth."+g,d).show();$(".auth:not(."+g+")",d).hide();setTimeout(function(e){$(".auth.body."+g+" input:first",e).focus()},200)}}).dialog({title:translate._("Verification"),resizable:false,modal:true,width:"420px",minHeight:"auto",buttons:[{text:translate._("Cancel"),click:function(){$(this).dialog("close")}},{text:translate._("OK"),click:function(){if($("input[name=passphrase]",this).length>0&&$("input[name=passphrase]",this).val().length<=0){alert(translate.sprintf(translate._("%s is empty"),translate._("Passphrase"))+".");return}var h=$(this);var j=$(":visible",this).serializeArray();var k=$(".login-list",this);var f=$("button.active",k).val();var g=b.event.name;var l=$.extend(b.event.args||{},{verification:f});$.each(j,function(o,n){l[n.name]=n.value});var e=$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane button:last-child").addClass("ui-state-disabled").prop("disabled",true).add($("input, button",this).prop("disabled",true));$(".error."+f,h).text("");if(f.indexOf("push")===0){$("<div class='spinner'>").append($("<i class='far fa-spinner fa-spin'>"),$("<span>").text(translate._("Sending")+"...")).insertAfter(k)}$.logmeonce.fireEvent(g,l).then(i,m,d);function i(n){$(".spinner",h).remove();h.dialog("close")}function m(n){if(n!=null&&n.exception!=null){alert(n.exception.message);$(".error."+f,h).text(n.exception.message)}e.removeClass("ui-state-disabled").prop("disabled",false);$(".spinner",h).remove();if($("input[name=password]",h).is(":visible")){$("input[name=password]",h).focus()}}function d(o){if(f.indexOf("push")===0){var p=translate._("Waiting")+"...";if(f==="push-login"&&o.otp!=null){p+=" "+translate._("Visual OTP")+": "+o.otp}$(".spinner span",h).text(p)}else{if(f==="mobileconnect"){function n(r){try{var q=JSON.parse(r.data);if(logmeonce.server.indexOf(r.origin)===0&&q.error!=null){window.removeEventListener("message",n,false);$("#mc-authorization").remove();setTimeout(m,100,{exception:{message:q.error}})}else{if(logmeonce.server.indexOf(r.origin)===0&&q.code!=null&&q.code!=null){window.removeEventListener("message",n,false);$(".spinner span",h).text(translate._("Verifying")+"...");$("#mc-authorization").remove();$.logmeonce.fireEvent(g,$.extend(l,q)).then(i,m,d)}}}catch(r){}}window.addEventListener("message",n,false,true);$("<iframe id='mc-authorization' frameBorder='0' type='content'>").attr("src",o.redirectUrl).css({background:"white",border:0,position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",zIndex:1002,display:o.visibility==null||o.visibility=="visible"?"block":"none"}).load(function(){/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&this.contentWindow.addEventListener("lmomc",function(q){n({origin:this.window.location.origin,data:JSON.stringify(q.detail)})},false,true)}).appendTo(document.body);$(".spinner span",h).text(translate._("Waiting for operator")+"...")}}}}}],open:function(){$(".login-list button",this).each(function(){if(typeof b[$(this).val()]!=="undefined"){$(this).prop("disabled",b[$(this).val()]===false)}});if(b.passphrase!=null){$("<div class='passphrase'>").append($("<h3>").text(translate._("Secure passphrase")),$("<div class='info'>").text(translate._("Secure passphrase for export")),$("<div class='body'>").css({display:"block"}).append($("<span>").text(translate._("Passphrase")+":"),$("<input type='text' name='passphrase'>").val(b.passphrase))).appendTo(this)}if($(".login-list button:not(disabled)."+b.authentication,this).length>0){$(".login-list button:not(disabled)."+b.authentication,this).trigger("click")}else{$(".login-list button.password",this).trigger("click")}}})});