$(document).on("ui",function(j,h){var c=h.url!=null&&h.url.length>0?h.url:"";var e={never:{text:translate._("Never Remember site"),click:function(){$.logmeonce.fireEvent("savePasswordManager",{ui:"never"}).fail(function(m){alert(m)});$(this).dialog("close")}},cancel:{text:translate._("Not Now"),click:function(){$.logmeonce.fireEvent("savePasswordManager",{ui:"skip"});$(this).dialog("close")}},save:{text:h.id!=null?translate._("Change"):translate._("Remember"),click:function(){if($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane button:last-child").hasClass("ui-state-disabled")){return}if($("input[name=username]",this).length>0&&$("input[name=username]",this).val().length<=0){if(!confirm(translate._("Are you sure you want to leave blank username?"))){return}$("input[name=username]",this).prop("disabled",true)}$.logmeonce.fireEvent("savePasswordManager",{ui:"save",id:$("select[name=site]",this).length>0?$("select[name=site]",this).val():null,username:$("select[name=username], input[name=username]:not(:disabled)",this).length>0?$("select[name=username], input[name=username]:not(:disabled)",this).val():null,group:$("select[name=group]",this).length>0?$("select[name=group]",this).val():null});$(this).dialog("close")}}};var i=[];var f=$("		<table>			<tr>				<td><div class='image-key'></div></td>				<td><span class='message'></span></td>			</tr>		</table>	");var a=$("<table align='center'></table>");if(h.id!=null){var d;if(h.username instanceof Array){h.username.sort(function(n,m){if(n.username!=null&&m.username!=null){if(n.username.toLowerCase()<m.username.toLowerCase()){return -1}if(n.username.toLowerCase()>m.username.toLowerCase()){return 1}}else{if(n.toLowerCase()<m.toLowerCase()){return -1}if(n.toLowerCase()>m.toLowerCase()){return 1}}return 0});var k=$("<select style='max-width: 200px' name='site'></select>");$.each(h.username,function(m,n){$("<option>").attr("value",n.id).text(n.username).appendTo(k)});d=$("<div>").append(k).html()}else{d=h.username!=null&&h.username.length>0?$("<div>").text('"'+h.username+'"').html():null}if(d!=null){$(".message",f).html(translate.sprintf(translate._("Change Password for %s on %s?"),d,c))}else{$(".message",f).html(translate.sprintf(translate._("Change Password on %s?"),c))}$(f).on("change","select[name=site]",function(){var m=$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane button:last-child");if($(this).val().trim().length>0){$(m).removeClass("ui-state-disabled")}else{$(m).addClass("ui-state-disabled")}});i=[e.cancel,e.save]}else{var d;if(h.username instanceof Array){var k=$("<select style='max-width: 200px' name='username'></select>");$.each(h.username,function(m,n){$("<option>").attr("value",n).text(n).appendTo(k)});d=$("<div>").append(k).html()}else{d=h.username!=null&&h.username.length>0?$("<div>").text('"'+h.username+'"').html():null}if(d!=null){$(".message",f).html(translate.sprintf(translate._("Remember Password for %s on %s?"),d,c))}else{$(".message",f).html(translate.sprintf(translate._("Remember Password on %s?"),c))}if(d==null){var l=translate._("Enter username or leave blank");$("<tr>").append($("<td>").append($("<span class='info'>").text(translate._("User Name")+":")),$("<td>").append($("<input type='text' name='username'>").attr("placeholder",l).attr("size",l.length))).appendTo(a)}if(h.groups!=null&&h.groups.length>0){$("<tr>").append($("<td>").append($("<span class='info'>").text(translate._("Groups")+":")),$("<td>").append($("<select name='group'>").append($.map(h.groups,function(m){return $("<option>").attr("value",m.id).prop("selected",!!m.selected).text(m.path||m.name)})))).appendTo(a)}if(h.never==null||h.never){i=[e.never,e.cancel,e.save]}else{i=[e.cancel,e.save]}}if($("tr",a).length>0){f=$("<div></div>").append(f).append(a)}if($("#ui-password-manager").length>0){$("#ui-password-manager").empty().append(f).css("height","auto");$("#ui-password-manager").closest(".ui-dialog").find(".ui-dialog-buttonpane button").removeClass("ui-state-disabled");$("#ui-password-manager").find("select[name=site]").trigger("change");$("#ui-password-manager").find("input[name=username]").trigger("keyup");$.ui.logmeonce.resize.call($("#ui-password-manager"))}else{var b=$("<div id='ui-password-manager' style='padding: .2em'></div>").append(f);var g=$(b).dialog({title:h.id!=null?translate._("Change Password"):translate._("Remember Password"),position:h.animate!=null?[0,0]:null,show:h.animate!=null?h.animate:null,hide:h.animate!=null?h.animate:null,width:430,resizable:false,autoOpen:false,draggable:h.draggable!=null?h.draggable:true,buttons:i,open:function(){$(this).css({height:"auto"});$("select[name=site]",this).trigger("change");$("input[name=username]",this).focus()}});g.dialog("widget").css("visibility","hidden");g.dialog("open");g.dialog("widget").css("visibility","visible")}});